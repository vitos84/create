$((function(){let o=!0;$(".switch-button").on("click",r=>{r.preventDefault(),o?(o=!1,$(".login").hide(),$(".registr").show("slow")):(o=!0,$(".login").show("slow"),$(".registr").hide()),$("form.login p.error, form.registr p.error").remove(),$("form.login input, form.registr input").removeClass("error")}),$("form.login input, form.registr input").on("focus",(function(){$("form.login p.error, form.registr p.error").remove(),$("form.login input, form.registr input").removeClass("error")})),$(".registr-button").on("click",o=>{o.preventDefault(),$("form.login p.error, form.registr p.error").remove(),$("form.login input, form.registr input").removeClass("error");const r={login:$("#login-registr").val(),password:$("#password-registr").val(),passwordConfirm:$("#password-registr-confirm").val()};console.log(r),$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/api/auth/registr"}).done(o=>{o.ok?$(location).attr("href","/"):($(".registr h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(o=>{$("input[name="+o+"]").addClass("error")}))}),$("input").on("focus",()=>{$("p.error").remove(),$("input.error").removeClass("error")})}),$(".login-button").on("click",o=>{o.preventDefault(),$("form.login p.error, form.registr p.error").remove(),$("form.login input, form.registr input").removeClass("error");const r={login:$("#login-login").val(),password:$("#login-password").val()};console.log(r),$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/api/auth/login"}).done(o=>{console.log(o),o.ok?$(location).attr("href","/"):($(".login h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(o=>{$("input[name="+o+"]").addClass("error")}))})})})),$((function(){$(".post-form input, #post-body").on("focus",(function(){$(".post-form p.error").remove(),$(".post-form input, #post-body").removeClass("error")})),$(".publisch-button").on("click",o=>{o.preventDefault();const r={title:$("#post-title").val(),body:$("#post-body").html()};$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/post/add"}).done(o=>{console.log(o),o.ok?$(location).attr("href","/"):($(".post-form h2").after('<p class="error">'+o.error+"</p>"),o.fields&&o.fields.forEach(o=>{$("#post-"+o).addClass("error")}))})}),$("#fileinfo").on("submit",(function(o){o.preventDefault(o);let r=new FormData(this);$.ajax({type:"POST",data:r,url:"/upload/image",processData:!1,contentType:!1,success:function(o){console.log(o)},error:function(o){console.log(o)}}).done().catch()}))})),$((function(){var o,r;function e(e,n){if(o&&o.remove(),r=null,o=$(".coment").clone(!0,!0),e)o.find(".cancel").hide(),o.appendTo(".coment-list");else{const e=$(n).parent();r=e.attr("id"),$(n).after(o)}o.css({display:"flex"})}e(!0),$(".reply").on("click",(function(){e(!1,this)})),$(".coment .cansel").on("click",(function(r){r.preventDefault(),o.remove()})),$(".coment .send").on("click",(function(n){n.preventDefault();const t={post:$(".coments").attr("id"),body:o.find("textarea").val(),parent:r};$.ajax({type:"POST",data:JSON.stringify(t),contentType:"application/json",url:"/coment/add"}).done(r=>{if(r.ok){const{login:n,body:t}=r,i=` <ul>\n                  <li style="background-color:red;">\n                    <div class="head">\n                      <a href="/users/${n}">\n                        ${n}\n                      </a>\n                      <spam class="date">\n                        только что\n                      </spam>\n                    </div>\n                    ${t}\n                  </li>\n            </ul>`;$(o).after(i),e(!0)}else void 0===r.error&&(r.error="неизвестная ошибка!",$(o).prepend('<p class="error">'+r.error+"</p>"))})}))}));